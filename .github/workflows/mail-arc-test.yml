name: A job to say hello

permissions:
  contents: write

on:
  workflow_dispatch:

jobs:
  hello_world_job:
    runs-on: arc-runner-set-dind

    steps:

      - name: Check Secrets
        run: |
          echo "SMTP_HOST: ${{ secrets.MAIL_HOST }}"
          echo "SMTP_USER: ${{ secrets.MAIL_USER }}"
          echo "SMTP_FROM: ${{ secrets.MAIL_FROM }}"
          echo "SMTP_TO: ${{ secrets.MAIL_TO }}"
          echo "DOCKERHUB_USERNAME: ${{ secrets.DOCKERHUB_USERNAME }}"

      - name: Hello world action step
        id: hello
        uses: YP-Docker/notify-with-mail@test-v1.0.2
        with:
          smtp_host: smtp.office365.com
          smtp_port: 587
          smtp_user: ${{ secrets.MAIL_USER }}
          smtp_password: ${{ secrets.MAIL_PASSWORD }}
          email_from: ${{ secrets.MAIL_FROM }}
          email_to: ${{ secrets.MAIL_TO }}
          email_subject: Build Notification - TEST MAIL !
          email_body: |
            <p>New Netbox images have been built and pushed to Docker HUB.</p>
            <p>The latest version of Netbox is: <strong>${{ needs.check_docker_hub.outputs.latest_tag }}</strong></p>
            <p>The Docker image tag is: <strong>${{ secrets.DOCKERHUB_USERNAME }}/nettools:netbox-${{ needs.check_docker_hub.outputs.latest_tag }}-build.${{ steps.tag_timestamp.outputs.timestamp }}</strong></p>
